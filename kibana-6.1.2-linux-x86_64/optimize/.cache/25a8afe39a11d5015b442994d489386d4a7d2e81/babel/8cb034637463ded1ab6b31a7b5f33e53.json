{"remainingRequest":"/home/vagrant/projects/kibana/build/kibana/node_modules/babel-loader/lib/index.js??ref--6-1!/home/vagrant/projects/kibana/build/kibana/src/ui/public/vislib/lib/layout/layout.js","dependencies":[{"path":"/home/vagrant/projects/kibana/build/kibana/src/ui/public/vislib/lib/layout/layout.js","mtime":1515552039000},{"path":"/home/vagrant/projects/kibana/build/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1493198456000},{"path":"/home/vagrant/projects/kibana/build/kibana/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.VislibLibLayoutLayoutProvider = VislibLibLayoutLayoutProvider;\n\nvar _d = require('d3');\n\nvar _d2 = _interopRequireDefault(_d);\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _jquery = require('jquery');\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _layout_types = require('./layout_types');\n\nvar _axis = require('ui/vislib/lib/axis');\n\nvar _chart_title = require('ui/vislib/lib/chart_title');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction VislibLibLayoutLayoutProvider(Private) {\n\n  var layoutType = Private(_layout_types.VislibLibLayoutLayoutTypesProvider);\n  var Axis = Private(_axis.VislibLibAxisProvider);\n  var ChartTitle = Private(_chart_title.VislibLibChartTitleProvider);\n  /**\n   * Builds the visualization DOM layout\n   *\n   * The Layout Constructor is responsible for rendering the visualization\n   * layout, which includes all the DOM div elements.\n   * Input:\n   *   1. DOM div - parent element for which the layout is attached\n   *   2. data - data is bound to the div element\n   *   3. chartType (e.g. 'histogram') - specifies the layout type to grab\n   *\n   * @class Layout\n   * @constructor\n   * @param el {HTMLElement} HTML element to which the chart will be appended\n   * @param data {Object} Elasticsearch query results for this specific chart\n   * @param chartType {Object} Reference to chart functions, i.e. Pie\n   */\n\n  var Layout = function () {\n    function Layout(config) {\n      _classCallCheck(this, Layout);\n\n      this.el = config.get('el');\n      this.data = config.data.data;\n      this.opts = config;\n      this.layoutType = layoutType[config.get('type')](this.el, this.data);\n    }\n\n    // Render the layout\n    /**\n     * Renders visualization HTML layout\n     * Remove all elements from the current visualization and creates the layout\n     *\n     * @method render\n     */\n\n\n    _createClass(Layout, [{\n      key: 'render',\n      value: function render() {\n        this.removeAll(this.el);\n        this.createLayout(this.layoutType);\n        // update y-axis-spacer height based on precalculated horizontal axis heights\n        if (this.opts.get('type') === 'point_series') {\n          this.updateCategoryAxisSize();\n        }\n      }\n\n      /**\n       * Create the layout based on the json array provided\n       * for each object in the layout array, call the layout function\n       *\n       * @method createLayout\n       * @param arr {Array} Json array\n       * @returns {*} Creates the visualization layout\n       */\n\n    }, {\n      key: 'createLayout',\n      value: function createLayout(arr) {\n        var _this = this;\n\n        return _lodash2.default.each(arr, function (obj) {\n          _this.layout(obj);\n        });\n      }\n    }, {\n      key: 'updateCategoryAxisSize',\n      value: function updateCategoryAxisSize() {\n        var visConfig = this.opts;\n        var axisConfig = visConfig.get('categoryAxes[0]');\n        var axis = new Axis(visConfig, axisConfig);\n        var position = axis.axisConfig.get('position');\n        var chartTitle = new ChartTitle(visConfig);\n\n        var axisWrapperElement = (0, _jquery2.default)(this.el).find('.axis-wrapper-' + position);\n\n        axisWrapperElement.css('visibility', 'hidden');\n        axis.render();\n        chartTitle.render();\n        var width = axisWrapperElement.width();\n        var height = axisWrapperElement.height();\n        axis.destroy();\n        (0, _jquery2.default)(this.el).find('.chart-title svg').remove();\n        axisWrapperElement.css('visibility', '');\n\n        if (axis.axisConfig.isHorizontal()) {\n          var spacerNodes = (0, _jquery2.default)(this.el).find('.y-axis-spacer-block-' + position);\n          spacerNodes.height(height + 'px');\n        } else {\n          axisWrapperElement.find('.y-axis-div-wrapper').width(width + 'px');\n        }\n      }\n\n      /**\n       * Appends a DOM element based on the object keys\n       * check to see if reference to DOM element is string but not class selector\n       * Create a class selector\n       *\n       * @method layout\n       * @param obj {Object} Instructions for creating the layout of a DOM Element\n       * @returns {*} DOM Element\n       */\n\n    }, {\n      key: 'layout',\n      value: function layout(obj) {\n        if (!obj.parent) {\n          throw new Error('No parent element provided');\n        }\n\n        if (!obj.type) {\n          throw new Error('No element type provided');\n        }\n\n        if (typeof obj.type !== 'string') {\n          throw new Error(obj.type + ' must be a string');\n        }\n\n        if (typeof obj.parent === 'string' && obj.parent.charAt(0) !== '.') {\n          obj.parent = '.' + obj.parent;\n        }\n\n        var childEl = this.appendElem(obj.parent, obj.type, obj.class);\n\n        if (obj.datum) {\n          childEl.datum(obj.datum);\n        }\n\n        if (obj.splits) {\n          childEl.call(obj.splits, obj.parent, this.opts);\n        }\n\n        if (obj.children) {\n          var newParent = childEl[0][0];\n\n          _lodash2.default.forEach(obj.children, function (obj) {\n            if (!obj.parent) {\n              obj.parent = newParent;\n            }\n          });\n\n          this.createLayout(obj.children);\n        }\n\n        return childEl;\n      }\n\n      /**\n       * Appends a `type` of DOM element to `el` and gives it a class name attribute `className`\n       *\n       * @method appendElem\n       * @param el {HTMLElement} Reference to a DOM Element\n       * @param type {String} DOM element type\n       * @param className {String} CSS class name\n       * @returns {*} Reference to D3 Selection\n       */\n\n    }, {\n      key: 'appendElem',\n      value: function appendElem(el, type, className) {\n        if (!el || !type || !className) {\n          throw new Error('Function requires that an el, type, and class be provided');\n        }\n\n        if (typeof el === 'string') {\n          // Create a DOM reference with a d3 selection\n          // Need to make sure that the `el` is bound to this object\n          // to prevent it from being appended to another Layout\n          el = _d2.default.select(this.el).select(el)[0][0];\n        }\n\n        return _d2.default.select(el).append(type).attr('class', className);\n      }\n\n      /**\n       * Removes all DOM elements from DOM element\n       *\n       * @method removeAll\n       * @param el {HTMLElement} Reference to DOM element\n       * @returns {D3.Selection|D3.Transition.Transition} Reference to an empty DOM element\n       */\n\n    }, {\n      key: 'removeAll',\n      value: function removeAll(el) {\n        return _d2.default.select(el).selectAll('*').remove();\n      }\n    }]);\n\n    return Layout;\n  }();\n\n  return Layout;\n}",null]}