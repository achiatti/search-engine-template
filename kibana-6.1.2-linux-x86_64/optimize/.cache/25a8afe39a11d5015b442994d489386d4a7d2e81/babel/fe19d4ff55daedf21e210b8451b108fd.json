{"remainingRequest":"/home/vagrant/projects/kibana/build/kibana/node_modules/babel-loader/lib/index.js??ref--6-1!/home/vagrant/projects/kibana/build/kibana/src/core_plugins/metrics/public/components/aggs/agg_select.js","dependencies":[{"path":"/home/vagrant/projects/kibana/build/kibana/src/core_plugins/metrics/public/components/aggs/agg_select.js","mtime":1515552029000},{"path":"/home/vagrant/projects/kibana/build/kibana/node_modules/cache-loader/dist/cjs.js","mtime":1493198456000},{"path":"/home/vagrant/projects/kibana/build/kibana/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactSelect = require('react-select');\n\nvar _reactSelect2 = _interopRequireDefault(_reactSelect);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar metricAggs = [{ label: 'Average', value: 'avg' }, { label: 'Cardinality', value: 'cardinality' }, { label: 'Count', value: 'count' }, { label: 'Filter Ratio', value: 'filter_ratio' }, { label: 'Max', value: 'max' }, { label: 'Min', value: 'min' }, { label: 'Percentile', value: 'percentile' }, { label: 'Percentile Rank', value: 'percentile_rank' }, { label: 'Static Value', value: 'static' }, { label: 'Std. Deviation', value: 'std_deviation' }, { label: 'Sum', value: 'sum' }, { label: 'Sum of Squares', value: 'sum_of_squares' }, { label: 'Value Count', value: 'value_count' }, { label: 'Variance', value: 'variance' }];\n\nvar pipelineAggs = [{ label: 'Bucket Script', value: 'calculation' }, { label: 'Cumulative Sum', value: 'cumulative_sum' }, { label: 'Derivative', value: 'derivative' }, { label: 'Moving Average', value: 'moving_average' }, { label: 'Positive Only', value: 'positive_only' }, { label: 'Serial Difference', value: 'serial_diff' }];\n\nvar siblingAggs = [{ label: 'Overall Average', value: 'avg_bucket' }, { label: 'Overall Max', value: 'max_bucket' }, { label: 'Overall Min', value: 'min_bucket' }, { label: 'Overall Std. Deviation', value: 'std_deviation_bucket' }, { label: 'Overall Sum', value: 'sum_bucket' }, { label: 'Overall Sum of Squares', value: 'sum_of_squares_bucket' }, { label: 'Overall Variance', value: 'variance_bucket' }];\n\nvar specialAggs = [{ label: 'Series Agg', value: 'series_agg' }];\n\nvar AggSelectOption = function (_Component) {\n  _inherits(AggSelectOption, _Component);\n\n  function AggSelectOption(props) {\n    _classCallCheck(this, AggSelectOption);\n\n    var _this = _possibleConstructorReturn(this, (AggSelectOption.__proto__ || Object.getPrototypeOf(AggSelectOption)).call(this, props));\n\n    _this.handleMouseMove = _this.handleMouseMove.bind(_this);\n    _this.handleMouseEnter = _this.handleMouseEnter.bind(_this);\n    _this.handleMouseDown = _this.handleMouseDown.bind(_this);\n    return _this;\n  }\n\n  _createClass(AggSelectOption, [{\n    key: 'handleMouseDown',\n    value: function handleMouseDown(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this.props.onSelect(this.props.option, event);\n    }\n  }, {\n    key: 'handleMouseEnter',\n    value: function handleMouseEnter(event) {\n      this.props.onFocus(this.props.option, event);\n    }\n  }, {\n    key: 'handleMouseMove',\n    value: function handleMouseMove(event) {\n      if (this.props.isFocused) return;\n      this.props.onFocus(this.props.option, event);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props$option = this.props.option,\n          label = _props$option.label,\n          heading = _props$option.heading,\n          pipeline = _props$option.pipeline;\n\n      var style = {\n        paddingLeft: heading ? 0 : 10\n      };\n      // We can ignore that the <div> does not have keyboard handlers even though\n      // it has mouse handlers, since react-select still takes care, that this works\n      // well with keyboard.\n      /* eslint-disable jsx-a11y/no-static-element-interactions */\n      if (heading) {\n        var note = void 0;\n        if (pipeline) {\n          note = _react2.default.createElement(\n            'span',\n            { className: 'vis_editor__agg_select-note' },\n            '(requires child aggregation)'\n          );\n        }\n        return _react2.default.createElement(\n          'div',\n          {\n            className: 'Select-option vis_editor__agg_select-heading',\n            onMouseEnter: this.handleMouseEnter,\n            onMouseDown: this.handleMouseDown,\n            onMouseMove: this.handleMouseMove,\n            'aria-label': label\n          },\n          _react2.default.createElement(\n            'span',\n            { className: 'Select-value-label', style: style },\n            _react2.default.createElement(\n              'strong',\n              null,\n              label\n            ),\n            note\n          )\n        );\n      }\n      return _react2.default.createElement(\n        'div',\n        {\n          className: this.props.className,\n          onMouseEnter: this.handleMouseEnter,\n          onMouseDown: this.handleMouseDown,\n          onMouseMove: this.handleMouseMove,\n          'aria-label': label\n        },\n        _react2.default.createElement(\n          'span',\n          { className: 'Select-value-label', style: style },\n          this.props.children\n        )\n      );\n      /* eslint-enable jsx-a11y/no-static-element-interactions */\n    }\n  }]);\n\n  return AggSelectOption;\n}(_react.Component);\n\nAggSelectOption.props = {\n  children: _propTypes2.default.node,\n  className: _propTypes2.default.string,\n  isDisabled: _propTypes2.default.bool,\n  isFocused: _propTypes2.default.bool,\n  isSelected: _propTypes2.default.bool,\n  onFocus: _propTypes2.default.func,\n  onSelect: _propTypes2.default.func,\n  option: _propTypes2.default.object.isRequired\n};\n\nfunction filterByPanelType(panelType) {\n  return function (agg) {\n    if (panelType === 'table') return agg.value !== 'series_agg';\n    return true;\n  };\n}\n\nfunction AggSelect(props) {\n  var siblings = props.siblings,\n      panelType = props.panelType;\n\n\n  var enablePipelines = siblings.some(function (s) {\n    return !!metricAggs.find(function (m) {\n      return m.value === s.type;\n    });\n  });\n  if (siblings.length <= 1) enablePipelines = false;\n\n  var options = void 0;\n  if (panelType === 'metrics') {\n    options = metricAggs;\n  } else {\n    options = [{ label: 'Metric Aggregations', value: null, heading: true, disabled: true }].concat(metricAggs, [{ label: 'Parent Pipeline Aggregations', value: null, pipeline: true, heading: true, disabled: true }], _toConsumableArray(pipelineAggs.filter(filterByPanelType(panelType)).map(function (agg) {\n      return _extends({}, agg, { disabled: !enablePipelines });\n    })), [{ label: 'Sibling Pipeline Aggregations', value: null, pipeline: true, heading: true, disabled: true }], _toConsumableArray(siblingAggs.map(function (agg) {\n      return _extends({}, agg, { disabled: !enablePipelines });\n    })), [{ label: 'Special Aggregations', value: null, pipeline: true, heading: true, disabled: true }], _toConsumableArray(specialAggs.map(function (agg) {\n      return _extends({}, agg, { disabled: !enablePipelines });\n    })));\n  }\n\n  var handleChange = function handleChange(value) {\n    if (value.disabled) return;\n    if (value.value) props.onChange(value);\n  };\n\n  return _react2.default.createElement(\n    'div',\n    { className: 'vis_editor__row_item' },\n    _react2.default.createElement(_reactSelect2.default, {\n      'aria-label': 'Select aggregation',\n      clearable: false,\n      options: options,\n      value: props.value,\n      optionComponent: AggSelectOption,\n      onChange: handleChange\n    })\n  );\n}\n\nAggSelect.propTypes = {\n  onChange: _propTypes2.default.func,\n  panelType: _propTypes2.default.string,\n  siblings: _propTypes2.default.array,\n  value: _propTypes2.default.string\n};\n\nexports.default = AggSelect;\nmodule.exports = exports['default'];",null]}